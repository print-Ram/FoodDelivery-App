<div class="container py-4" *ngIf="user">
  <h2 class="mb-4 text-white fw-bold text-center">Account Settings</h2>

  <div class="row g-4">
    <div class="col-md-6" *ngFor="let field of fields">
      <div class="flip-card" (click)="toggleFlip(field.key)">
        <div class="flip-card-inner" [class.flipped]="flipped[field.key]">
          
          <!-- Front -->
          <div class="flip-card-front p-4 bg-light border rounded shadow-sm text-dark">
            <h5 class="mb-1 text-capitalize fw-semibold">Change {{ field.label }}</h5>
            <p class="mb-0 text-secondary">
              Click to {{ field.key === 'password' ? 'change' : 'edit' }}
            </p>
          </div>

          <!-- Back -->
          <div class="flip-card-back p-4 bg-white border rounded shadow-sm text-dark">
            <label class="form-label fw-semibold">{{ field.label }}</label>

            <!-- Password field with toggle icon -->
            <div *ngIf="field.key === 'password'" class="position-relative">
              <input
                [type]="showPassword ? 'text' : 'password'"
                class="form-control pe-5"
                [(ngModel)]="user.password"
                name="password"
                (click)="$event.stopPropagation()"
              />
              <i
                class="bi"
                [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"
                (click)="togglePasswordVisibility($event)"
                style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); cursor: pointer;"
              ></i>
            </div>

            <!-- Other fields -->
            <input
              *ngIf="field.key !== 'password'"
              type="text"
              class="form-control"
              [(ngModel)]="user[field.key]"
              [name]="field.key"
              (click)="$event.stopPropagation()"
            />
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Save Button -->
  <div class="mt-4 text-center">
    <button class="btn btn-primary px-4 py-2 fw-semibold" (click)="updateUser()">Save Changes</button>
  </div>
</div>

<div *ngIf="showToast" class="position-fixed bottom-0 end-0 p-3" style="z-index: 1055;">
  <div class="toast show align-items-center text-bg-success border-0">
    <div class="d-flex">
      <div class="toast-body">
        {{ toastMessage }}
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" (click)="showToast = false"></button>
    </div>
  </div>
</div>

